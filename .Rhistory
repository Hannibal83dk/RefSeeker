#'
#' \dontrun{
#' rs_exporttable(res, filename = "../data/EOCstability", tabletype = "csv", addDate = TRUE )
#'
#' }
#'
#'
#'
rs_exporttable <- function(refseekerlist, filename = "Stability-table", tabletype = "xlsx", addDate = TRUE){
#print(substitute(refseekerlist)[[3]])
if(!is.null(refseekerlist$stabilityTable)){
templist <- list(refseekerlist)
cat("1")
names(templist)  <- substitute(refseekerlist)[[3]]
cat("2")
}
return(templist)
return(substitute(refseekerlist))
if(tabletype == "xlsx"){
rs_exceltable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "ods"){
rsodstable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "csv"){
rscsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "tsv"){
#cat("running tsvtable\n")
rstsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "txt"){
#cat("running txttable\n")
rstxttable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "docx-stability"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "stability", addDate = addDate)
}
if(tabletype == "docx-rank"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "rank", addDate = addDate)
}
if(tabletype == "docx-combi"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "both", addDate = addDate)
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
#' dimnames(ct_vals)[[2]] <-  c("gene1", "gene2", "gene3", "gene4", "gene5")
#' res <- rs_reffinder(ct_vals)
#'
#' \dontrun{
#' rs_exporttable(res, filename = "../data/EOCstability", tabletype = "csv", addDate = TRUE )
#'
#' }
#'
#'
#'
rs_exporttable <- function(refseekerlist, filename = "Stability-table", tabletype = "xlsx", addDate = TRUE){
#print(substitute(refseekerlist)[[3]])
if(!is.null(refseekerlist$stabilityTable)){
templist <- list(refseekerlist)
cat("1")
names(templist)  <- as.character(substitute(refseekerlist)[[3]])
cat("2")
}
return(templist)
return(substitute(refseekerlist))
if(tabletype == "xlsx"){
rs_exceltable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "ods"){
rsodstable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "csv"){
rscsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "tsv"){
#cat("running tsvtable\n")
rstsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "txt"){
#cat("running txttable\n")
rstxttable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "docx-stability"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "stability", addDate = addDate)
}
if(tabletype == "docx-rank"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "rank", addDate = addDate)
}
if(tabletype == "docx-combi"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "both", addDate = addDate)
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
library(RefSeeker)
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
rm(rs_exporttable)
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
#' dimnames(ct_vals)[[2]] <-  c("gene1", "gene2", "gene3", "gene4", "gene5")
#' res <- rs_reffinder(ct_vals)
#'
#' \dontrun{
#' rs_exporttable(res, filename = "../data/EOCstability", tabletype = "csv", addDate = TRUE )
#'
#' }
#'
#'
#'
rs_exporttable <- function(refseekerlist, filename = "Stability-table", tabletype = "xlsx", addDate = TRUE){
#print(substitute(refseekerlist)[[3]])
if(!is.null(refseekerlist$stabilityTable)){
templist <- list(refseekerlist)
names(templist)  <- as.character(substitute(refseekerlist)[[3]])
}
if(tabletype == "xlsx"){
rs_exceltable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "ods"){
rsodstable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "csv"){
rscsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "tsv"){
#cat("running tsvtable\n")
rstsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "txt"){
#cat("running txttable\n")
rstxttable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "docx-stability"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "stability", addDate = addDate)
}
if(tabletype == "docx-rank"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "rank", addDate = addDate)
}
if(tabletype == "docx-combi"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "both", addDate = addDate)
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
#' dimnames(ct_vals)[[2]] <-  c("gene1", "gene2", "gene3", "gene4", "gene5")
#' res <- rs_reffinder(ct_vals)
#'
#' \dontrun{
#' rs_exporttable(res, filename = "../data/EOCstability", tabletype = "csv", addDate = TRUE )
#'
#' }
#'
#'
#'
rs_exporttable <- function(refseekerlist, filename = "Stability-table", tabletype = "xlsx", addDate = TRUE){
#print(substitute(refseekerlist)[[3]])
if(!is.null(refseekerlist$stabilityTable)){
templist <- list(refseekerlist)
names(templist)  <- as.character(substitute(refseekerlist)[[3]])
refseekerlist <- templist
}
if(tabletype == "xlsx"){
rs_exceltable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "ods"){
rsodstable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "csv"){
rscsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "tsv"){
#cat("running tsvtable\n")
rstsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "txt"){
#cat("running txttable\n")
rstxttable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "docx-stability"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "stability", addDate = addDate)
}
if(tabletype == "docx-rank"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "rank", addDate = addDate)
}
if(tabletype == "docx-combi"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "both", addDate = addDate)
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
#' dimnames(ct_vals)[[2]] <-  c("gene1", "gene2", "gene3", "gene4", "gene5")
#' res <- rs_reffinder(ct_vals)
#'
#' \dontrun{
#' rs_exporttable(res, filename = "../data/EOCstability", tabletype = "csv", addDate = TRUE )
#'
#' }
#'
#'
#'
rs_exporttable <- function(refseekerlist, filename = "Stability-table", tabletype = "xlsx", addDate = TRUE){
#print(substitute(refseekerlist)[[3]])
if(!is.null(refseekerlist$stabilityTable)){
templist <- list(refseekerlist)
names(templist)  <- as.character(substitute(refseekerlist)[[3]])
refseekerlist <- templist
print(refseekerlist)
}
if(tabletype == "xlsx"){
rs_exceltable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "ods"){
rsodstable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "csv"){
rscsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "tsv"){
#cat("running tsvtable\n")
rstsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "txt"){
#cat("running txttable\n")
rstxttable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "docx-stability"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "stability", addDate = addDate)
}
if(tabletype == "docx-rank"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "rank", addDate = addDate)
}
if(tabletype == "docx-combi"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "both", addDate = addDate)
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
refseekerlist
length(refseekerlist)
templist <- list(refseekerlist)
names(templist)  <- as.character(substitute(refseekerlist)[[3]])
refseekerlist <- templist
print(refseekerlist)
#' dimnames(ct_vals)[[2]] <-  c("gene1", "gene2", "gene3", "gene4", "gene5")
#' res <- rs_reffinder(ct_vals)
#'
#' \dontrun{
#' rs_exporttable(res, filename = "../data/EOCstability", tabletype = "csv", addDate = TRUE )
#'
#' }
#'
#'
#'
rs_exporttable <- function(refseekerlist, filename = "Stability-table", tabletype = "xlsx", addDate = TRUE){
#print(substitute(refseekerlist)[[3]])
if(!is.null(refseekerlist$stabilityTable)){
templist <- list(refseekerlist)
names(templist)  <- "Fesh_Frozen" # as.character(substitute(refseekerlist)[[3]])
refseekerlist <- templist
print(refseekerlist)
}
if(tabletype == "xlsx"){
rs_exceltable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "ods"){
rsodstable(refseekerlist = refseekerlist, filename = filename, addDate = addDate)
}
if(tabletype == "csv"){
rscsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "tsv"){
#cat("running tsvtable\n")
rstsvtable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "txt"){
#cat("running txttable\n")
rstxttable(refseekerlist, filename, addDate = addDate)
}
if(tabletype == "docx-stability"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "stability", addDate = addDate)
}
if(tabletype == "docx-rank"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "rank", addDate = addDate)
}
if(tabletype == "docx-combi"){
#cat("running txttable\n")
rsdoctable(refseekerlist, filename = filename, tabletype = "both", addDate = addDate)
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
refseekerlist
templist
names(templist)  <- "Fesh_Frozen"
refseekerlist
templist
refseekerlist <- templist
print(refseekerlist)
names(refseekerlist)
# Save the names of the datasets
nms <- names(refseekerlist)
length(refseekerlist)
addDate
newfilename <- paste0(filename, "_", nms[i], "_StabilityTable_", Sys.Date(), ".csv")
# Save the names of the datasets
nms <- names(refseekerlist)
newfilename <- paste0(filename, "_", nms[i], "_StabilityTable_", Sys.Date(), ".csv")
i =1
newfilename <- paste0(filename, "_", nms[i], "_StabilityTable_", Sys.Date(), ".csv")
newfilename
filename
refseekerlist[[i]][1]
utils::write.csv(refseekerlist[[i]][1], newfilename, row.names = FALSE)
refseekerlist
st[[i]][1]
refseekerlist[[i]][1]
refseekerlist[[i]][[1]]
#'
#'  data <- rs_miRNA
#'  res <- rs_reffinder(data)
#'  rscsvtable(res, "path/to/folder", filenameprefix = "EOC")
#' }
#'
#'
#'
#'
#'
rscsvtable <- function(refseekerlist, filename, addDate = TRUE) {
cat("Starting csvtable\n")
# Save the names of the datasets
nms <- names(refseekerlist)
# For each data set, print two csv files, stabiltiy value and stability ranking
for (i in 1:length(refseekerlist)) {
# Create the file name with or without date
if(addDate){
newfilename <- paste0(filename, "_", nms[i], "_StabilityTable_", Sys.Date(), ".csv")
} else {
newfilename <- paste0(filename, "_", nms[i], "_StabilityTable_", ".csv")
}
utils::write.csv(refseekerlist[[i]][[1]], newfilename, row.names = FALSE)
# Report absolute path of file.
cat(paste0("csv file created at: ", absfilepath(newfilename), "\n"))
# if(dirname(filename) == "."){
#   cat(paste0("csv file created at: ", getwd(),"/", newfilename, "\n"))
# } else {
#   cat(paste("csv file created at: ", newfilename, "\n"))
# }
# Create the file name with or without date
if(addDate){
newfilename <- paste0(filename, "_", nms[i], "_RankTable_", Sys.Date(), ".csv")
} else {
newfilename <- paste0(filename, "_", nms[i], "_RankTable_", ".csv")
}
utils::write.csv(refseekerlist[[i]][[2]], newfilename, row.names = FALSE)
# Report absolute path of file.
cat(paste0("csv file created at: ", absfilepath(newfilename), "\n"))
}
}
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
library(RefSeeker)
rm(rs_exporttable)
rm(rscsvtable)
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "csv")
rs_exporttable(results, "txttest", tabletype = "csv")
rs_wizard()
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "tsv")
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "tsv")
library(RefSeeker)
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "tsv")
rs_exporttable(results$Fresh_Frozen, "txttest", tabletype = "txt")
library(RefSeeker)
data <- rs_loaddata()
res <- rs_reffinder(data)
rs_exporttable(res, "exceloutexample")
getwd()
library(RefSeeker)
data <- rs_loaddata()
res <- rs_reffinder(data)
rs_wizard()
rs_wizard()
data <- rs_loaddata()
data
Normfinder
rs_normfinderFull(data, Groups = FALSE)
rs_normfinderFull(data$data_no_miss_RF_in, Groups = FALSE)
View(data)
library(RefSeeker)
rs_exporttable(rs_results, filename = "cohort1", tabletype = "xlsx")
rs_results
rs_data <- rs_loaddata("../inst/exdata/vignetteInputs/RefSeeker_data_test.xlsx")
rs_results <- rs_reffinder(rs_data)
rs_results <- rs_reffinder(rs_data)
rs_results
rs_exporttable(rs_results, filename = "cohort1", tabletype = "xlsx")
<img src="xlout.png" title="Selecting file dialog" alt="Excel example" width="99%" style="display: block; margin: auto;" />
<br>
<br>
rs_exporttable(rs_results, filename = "cohort1", tabletype = "docx-stability")
rs_exporttable(rs_results, filename = "cohort1", tabletype = "docx-rank")
getwd()
rs_exporttable(rs_results, filename = "./cohort1", tabletype = "docx-rank")
rs_exporttable(rs_results, filename = "./cohort1", tabletype = "docx-rank")
rs_exporttable(rs_results, filename = "cohort1", tabletype = "docx-stability")
rs_exporttable(rs_results, filename = "./cohort1", tabletype = "docx-rank")
rs_exporttable(rs_results, filename = "cohort1", tabletype = "docx-combi")
library(RefSeeker)
results
rs_graph(rs_results, forceSingle = TRUE)
rs_graph(results)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
results[1]
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
refseekerlist
results
list(refseekerlist[i])
results[1]
results[1][[1]]
results[1][[1]]$stabilityTable
rs_graph(rs_results, forceSingle = TRUE)
order(results[1][[i]]$stabilityTable[,sortcol])
order(results[1][[i]]$stabilityTable[,"Comprehensive Rank"])
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
rs_graph(rs_results, forceSingle = TRUE)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
print(graphs)
graphs
graphs{1}
graphs[1]
library(RefSeeker)
graphs[1]
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
graphs
graphs[1]
print(graphs)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
print(graphs[[1]])
library(RefSeeker)
print(graphs[[1]])
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
graphs[1]
print(graphs)
library(RefSeeker)
library(RefSeeker)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
graphs <- rs_graph(rs_results, forceSingle = TRUE)
library(RefSeeker)
library(RefSeeker)
rs_loaddata(
)
library(RefSeeker)
data <- rs_loaddata()
results <- rs_reffinder(data)
results
rs_graph(results)
rs_graph(results, "demo", filetype = "png")
rs_exporttable(results, tabletype = "docx-combi")
rs_wizard()
getwd()
rmarkdown::render('Loading_data_sources.Rmd', output_format = "html", output_file = Loading_data_sources.html, output_dir = "./doc")
rmarkdown::render('./vignettes/Loading_data_sources.Rmd', output_format = "html", output_file = Loading_data_sources.html, output_dir = "./doc")
rmarkdown::render('./vignettes/Loading_data_sources.Rmd', output_format = "html_document", output_file = Loading_data_sources.html, output_dir = "./doc")
rmarkdown::render('./vignettes/Loading_data_sources.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/Staability_Analysis.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/Stability_Analysis.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/Stability_Analysis.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/RefSeeker-intro.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/ExportStabilityGraphs.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/ExportStabilityGraphs.Rmd', output_format = "html_document", output_dir = "./doc")
rmarkdown::render('./vignettes/ExportingTables.Rmd', output_format = "html_document", output_dir = "./doc")
