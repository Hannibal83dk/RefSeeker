---
title: "Obtain stability ranking from raw expression data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Obtain stability ranking from raw expression data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```



The refSeeker package provides a convenient way of analyzing target stabilities from raw Cp/Ct/Cq values expression data of set of samples.
It uses the refSeeker method which includes a stabilities calculated by four different algorithms: Normfinder, geNorm, bestKeeper and delta-Ct.
The target stabilities are then ranked and a geometric mean of the ranking from each algorithm is then calculated as the comprehensive ranking.

The package include functions for easy import of raw data, extraction of stability values for each algorithm and an easy way of exporting these data either for further use. Either in the form of excel files or as csv files.

After installation the library is loaded as all other packages.

```{r setup}
library(refSeeker)
```


The function contained in the refSeeker package has all been given the prefix "rs". Function that are meant to be used by user has the prefix "rs_".
The "rs" without the underscore are mostly helpers for the other functions.


## Data input requirements

Input data can be loaded in various ways as long as the following requirements are met:

- Needs to be in the form of matrices, data frames or a tibbles.

- Each column must be representing a gene/target and each row representing an individual sample.

- Each column must be named.

- Row names must be excluded


## Analysing a single expreiment

A randomly generated example can be seen below:

```{r data example 1}
set.seed(100)
ct_vals <- matrix(rnorm(5*20, mean = 25), ncol = 5, nrow = 20)
dimnames(ct_vals)[[2]] <-  c("gene1", "gene2", "gene3", "gene4", "gene5")
ct_vals
```

To obtain the refSeeker results all just run:

```{r}
rs_results <- rs_reffinder(ct_vals)
rs_results
```

This produces a list of two tables. A table containing target stability values for each algorithm and a ranking table that ranks the most stable from 1 to N number of targets.


To create an excel file containing the tables:
```{r eval=FALSE}
rs_exporttable(rs_results, "./output/folder/sample_excel_tables", tabletype = "xlsx")
```

The two tables will appear in the excel file as separate sheets with filter options.



For a nice visualization of the stabilities, use:

```{r refSeeker-intro_fig, fig.asp = 1, fig.width = 9, out.width="99%", fig.align='center'}
rs_graph(rs_results)

```


To print the graph as a Png file, just add a file name and set outputPng = TRUE:

```{r eval=FALSE}
rs_graph(rs_results, "./output/folder/Sample stability", outputPng = TRUE)

```


Et voilÃ ! Now you can select the targets with the lowest stability value as reference genes for your expression studies


## Analysing a batch of experiments

To analyse more sets in a batch, create an excel file containing one data set on each sheet, rename each sheet for easy identification of output files.
run the following:
```{r eval=FALSE}
rs_wizard()
```

No parameters are required, the wizard will guide you.

- First a file select dialog window will appear - find and select the excel data file.

- Second a dialog will appear to let you select an output folder - select working directory or browse for a folder.

- Third excel files containing your stability and ranking tables and png-graphs will now appear in the selected output folder.


<br>
<br>
<br>
<br>
<br>
<br>






