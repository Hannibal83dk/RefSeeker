

# #' Creates batch output from selected excel file
# #'
# #' @return Nothing. Creates excel files and graphs with stabilities for each sheet of a selected excel file
# #' @export
# #'
# #'
# #' @import readxl
# #'
# #'
# #' @examples
# #' \dontrun{
# #' rs_batchExcel()
# #' }
# #'
# #'
# #'
# rs_batchExcel <- function(){
#
#   filepath <- file.choose()
#
#   outdir <- rsoutdirselect()
#
#   sheets <- excel_sheets(filepath)
#
#   if(is.na(outdir)){outdir <- getwd()}
#
#   for (i in 1: length(sheets)) {
#
#     temp_data <- read_excel(filepath, i)
#     ref_temp <- rs_reffinder(temp_data)
#     rs_exceltable(ref_temp, paste(outdir, "/", sheets[i], sep = ""))
#     cat("\n")
#     rs_graph(ref_temp, paste(outdir, "/", sheets[i], sep = ""))
#     cat("\n")
#   }
# }



# #' Creates batch output from selected excel file
# #'
# #' @param input A path to an excel file containing properly formatted reffinder data tables. This means column representing genes/targets and rows representing samples,
# #' data being Ct/Cp/Cq values, with no missing data since the validity of these results have not been confirmed.
# #' @param outdir A selected output directory, if not set a dialog will appear to allow selection for output directory
# #' @param printgraph If TRUE print a graph of the result in the output folder
# #'
# #' @return Nothing. Creates excel files and graphs with stabilities for each sheet of a selected excel file
# #' @export
# #'
# #'
# #' @import readxl
# #'
# #'
# #' @examples
# #' \dontrun{
# #' rs_batchExcel()
# #' }
# #'
# #'
# #'
# #'
# rs_batchExcel2 <- function(input = "", outdir = "", printgraph = TRUE){
#
#   filepath <- file.choose()
#
#   rfres <- rs_reffinder(rs_loadexceldata(filepath))
#
#   outdir <- rsoutdirselect()
#
#
#   if(is.na(outdir)){outdir <- getwd()}
#
#   graphtype <- rsgraphtypeselect()
#   cat(graphtype)
#
#   nms <- names(rfres)
#
#   #exltype <- rsexltypeselect()
#
#   if(graphtype == "single"){
#
#     for (i in 1:length(nms)) {
#
#       temp <- rfres[i]
#       rs_graph(rfres[[i]], paste0(outdir, "/", nms[i]), forceSingle =TRUE)
#     }
#
#   } else if(graphtype == "multi"){
#     rs_graph(rfres, paste(outdir, "/", tools::file_path_sans_ext(basename(filepath)), sep = ""))
#   }
#
#
#   for (i in 1: length(nms)) {
#
#     rs_exceltable(rfres[[i]], paste(outdir, "/", nms[i], sep = ""))
#
#   }
# }





########################

#' Creates batch output from selected excel file
#'
#' @param filepath A path to an excel file containing properly formatted reffinder data tables. This means column representing genes/targets and rows representing samples,
#' data being Ct/Cp/Cq values, with no missing data since the validity of these results have not been confirmed.
#'
#' @param outdir A selected output directory, if not set a dialog will appear to allow selection for output directory
#' @param graphtype Select the type of graph, may be set to: "none", "multi or "single". Can be left or set to empty: "". To allow for selection by dialog.
#' @param ... Additional parameter to pass to the rs_graph function.
#'
#' @return Nothing. Creates excel files and graphs with stabilities for each sheet of a selected excel file
#' @export
#'
#'
#' @import readxl
#'
#'
#'
#'
#' @examples
#' \dontrun{
#' rs_batchExcel()
#' }
#'


# rs_batchExcel <- function(filepath = "", outdir = "", graphtype = ""){
#
#
#   # Selection of input file if none given
#   if(filepath == "") filepath <- file.choose()
#
#   rfres <- rs_reffinder(rs_loadexceldata(filepath))
#
#   # Selection of output directory if none given
#   if(outdir == "") outdir <- rsoutdirselect()
#
#   if(is.na(outdir)){outdir <- getwd()}
#
#   # Selection of graph type if none given
#   if(graphtype == "") graphtype <- rsgraphtypeselect()
#
#   nms <- names(rfres)
#
#   #exltype <- rsexltypeselect()
#   if(graphtype!="none"){ # If graph type is not "none" something should be printet
#
#     if(graphtype == "single"){
#
#       rs_graph(rfres, paste0(outdir,"/"), forceSingle = TRUE)
#
#     } else if(graphtype == "multi"){
#       rs_graph(rfres, paste0(outdir, "/", tools::file_path_sans_ext(basename(filepath)))    )
#     }
#
#   }
#
#
#   for (i in 1: length(nms)) {
#
#     rs_exceltable(rfres[[i]], paste(outdir, "/", nms[i], sep = ""))
#
#   }
# }


#rs_batchExcel(graphtype = "multi")









